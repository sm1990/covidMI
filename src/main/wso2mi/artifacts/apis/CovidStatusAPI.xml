<api xmlns="http://ws.apache.org/ns/synapse" name="CovidStatusAPI" context="/covid">
    <resource methods="GET" uri-template="/status">
        <inSequence>
            <log category="INFO">
                <message>Fetching global COVID-19 status</message>
            </log>
            <payloadFactory media-type="text" template-type="default">
                <format>Covid response</format>
            </payloadFactory>
            <respond/>
        </inSequence>
        <faultSequence>
            <log category="ERROR">
                <message>Error occurred while fetching COVID-19 data: ${props.synapse.ERROR_MESSAGE}</message>
            </log>
            <payloadFactory media-type="json">
                <format>
                    {
                    "error": "Failed to fetch COVID-19 data",
                    "message": "Service temporarily unavailable"
                    }
                </format>
            </payloadFactory>
            <respond/>
        </faultSequence>
    </resource>
</api>
